<?xml version="1.0" encoding="UTF-8" ?>
<odoo>
    <data noupdate="0">

        <!-- ============================================ -->
        <!-- ir.rule : visibilité des demandes            -->
        <!-- ============================================ -->

        <!-- Utilisateurs voient leurs propres demandes + celles qu'ils peuvent approuver -->
        <record id="rule_demande_user" model="ir.rule">
            <field name="name">Demandes : mes demandes ou à approuver</field>
            <field name="model_id" ref="model_isic_approbation_demande" />
            <field name="groups" eval="[(4, ref('base.group_user'))]" />
            <field name="domain_force">[
                '|',
                ('demandeur_id', '=', user.id),
                ('reviewer_ids', 'in', user.id),
            ]</field>
        </record>

        <!-- Direction voit toutes les demandes -->
        <record id="rule_demande_direction" model="ir.rule">
            <field name="name">Demandes : accès total direction</field>
            <field name="model_id" ref="model_isic_approbation_demande" />
            <field name="groups" eval="[(4, ref('isic_base.group_isic_direction'))]" />
            <field name="domain_force">[(1, '=', 1)]</field>
        </record>

    </data>
</odoo>
